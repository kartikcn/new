<div class="card">
    <div style="margin: 10px">
        <button type="button" (click)="exportExcel()" pButton pRipple icon="pi pi-file-excel" matTooltip="XLS" matTooltipPosition="below"
            class="p-button-success p-mr-2 pull-right" [disabled]="rm_data.length==0"></button>
    </div>
    <p-table  [value]="rm_data" [paginator]="true" [rows]="rowCount" [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [rowsPerPageOptions]="[5,10,25]"
    styleClass="p-datatable-responsive-demo p-datatable-gridlines" [rowHover]="false" [scrollable]="true"
    scrollDirection="both" scrollHeight="350px" [totalRecords]="rm_data.length">
    <ng-template pTemplate="header">
      <tr>
        <th style="width:4rem"></th>
        <th pSortableColumn="blId">
          <div class="grid-header-column">
            <div class="grid-header-label">
              <p class="grid-label-paragraph">Building Code</p>
            </div>
            <div class="grid-sort-icon">
              <p-sortIcon field="blId"></p-sortIcon>
              <p-columnFilter type="text" field="blId" display="menu"></p-columnFilter>
            </div>
          </div>
        </th>
        <th pSortableColumn="flId">
          <div class="grid-header-column">
            <div class="grid-header-label">
              <p class="grid-label-paragraph"> Floor Code</p>
            </div>
            <div class="grid-sort-icon">
              <p-sortIcon field="flId"></p-sortIcon>
              <p-columnFilter type="text" field="flId" display="menu"></p-columnFilter>
            </div>
          </div>
        </th>
        <th pSortableColumn="rmId">
          <div class="grid-header-column">
            <div class="grid-header-label">
              <p class="grid-label-paragraph"> Room Code</p>
            </div>
            <div class="grid-sort-icon">
              <p-sortIcon field="rmId"></p-sortIcon>
              <p-columnFilter type="text" field="rmId" display="menu"></p-columnFilter>
            </div>
          </div>
        </th>
        <th pSortableColumn="divId">
          <div class="grid-header-column">
            <div class="grid-header-label">
              <p class="grid-label-paragraph"> Division</p>
            </div>
            <div class="grid-sort-icon">
              <p-sortIcon field="divId"></p-sortIcon>
              <p-columnFilter type="text" field="divId" display="menu"></p-columnFilter>
            </div>
          </div>
        </th>
        <th pSortableColumn="depId">
            <div class="grid-header-column">
              <div class="grid-header-label">
                <p class="grid-label-paragraph"> Department</p>
              </div>
              <div class="grid-sort-icon">
                <p-sortIcon field="depId"></p-sortIcon>
                <p-columnFilter type="text" field="depId" display="menu"></p-columnFilter>
              </div>
            </div>
          </th>
        <th>Total Space</th>
        <th>Occupied Space</th>
        <th>Available Space</th>
        <th>Occupancy (%)</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rm>
      <tr [pSelectableRow]="rm">
        <td style="width:4rem">
          <button pButton pRipple type="button" icon="pi pi-eye" (click)="viewItem(rm)"
            class="p-button-text p-button-rounded pull-right">
          </button>
        </td>
        <td>{{rm.blId}}</td>
        <td>{{rm.flId}}</td>
        <td>{{rm.rmId}}</td>
        <td>{{rm.divId}}</td>
        <td>{{rm.depId}}</td>
        <td>{{rm.totalSpace}}</td>
        <td>{{rm.occupiedSpace}}</td>
        <td>{{rm.availableSpace}}</td>
        <td>{{rm.occupiedPercentage}}</td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage" let-columns>
      <tr>
        <td [attr.colspan]="7">
          No records found
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
