{"ast":null,"code":"import { MatSort } from '@angular/material/sort';\nimport { UtilConstant } from '../../../../common/UtilConstant';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatDialogConfig } from '@angular/material/dialog';\nimport { EnumList } from 'src/app/model/enum-list.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/employee.service\";\nimport * as i2 from \"../provider/employee.provider\";\nimport * as i3 from \"../../../services/enum.service\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"primeng/api\";\nimport * as i6 from \"primeng/table\";\nimport * as i7 from \"primeng/button\";\nimport * as i8 from \"primeng/dropdown\";\nimport * as i9 from \"primeng/panel\";\nimport * as i10 from \"../../../core/level-status/level-status.component\";\nimport * as i11 from \"primeng/paginator\";\nfunction DefineEmployeeComponent_ng_template_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function DefineEmployeeComponent_ng_template_2_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r5.onAddEmployee());\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DefineEmployeeComponent_ng_template_6_ng_template_50_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"p-dropdown\", 36);\n    i0.ɵɵlistener(\"onChange\", function DefineEmployeeComponent_ng_template_6_ng_template_50_Template_p_dropdown_onChange_0_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const filter_r9 = restoredCtx.filterCallback;\n      return i0.ɵɵresetView(filter_r9($event.value));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const value_r8 = ctx.$implicit;\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngModel\", value_r8)(\"options\", ctx_r7.enumEmStatus)(\"showClear\", true);\n  }\n}\nfunction DefineEmployeeComponent_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelement(1, \"th\", 12);\n    i0.ɵɵelementStart(2, \"th\", 13)(3, \"div\", 14)(4, \"div\", 15)(5, \"p\", 16);\n    i0.ɵɵtext(6, \"Employee Code\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 17);\n    i0.ɵɵelement(8, \"p-sortIcon\", 18)(9, \"p-columnFilter\", 19);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"th\", 20)(11, \"div\", 14)(12, \"div\", 15)(13, \"p\", 16);\n    i0.ɵɵtext(14, \" First Name\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 17);\n    i0.ɵɵelement(16, \"p-sortIcon\", 21)(17, \"p-columnFilter\", 22);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"th\", 23)(19, \"div\", 14)(20, \"div\", 15)(21, \"p\", 16);\n    i0.ɵɵtext(22, \" Last Name\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 17);\n    i0.ɵɵelement(24, \"p-sortIcon\", 24)(25, \"p-columnFilter\", 25);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(26, \"th\", 26)(27, \"div\", 14)(28, \"div\", 15)(29, \"p\", 16);\n    i0.ɵɵtext(30, \" Email\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(31, \"div\", 17);\n    i0.ɵɵelement(32, \"p-sortIcon\", 27)(33, \"p-columnFilter\", 28);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(34, \"th\", 29)(35, \"div\", 14)(36, \"div\", 15)(37, \"p\", 16);\n    i0.ɵɵtext(38, \" Employee Standard\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(39, \"div\", 17);\n    i0.ɵɵelement(40, \"p-sortIcon\", 30)(41, \"p-columnFilter\", 31);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(42, \"th\", 32)(43, \"div\", 14)(44, \"div\", 15)(45, \"p\", 16);\n    i0.ɵɵtext(46, \"Status\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"div\", 17);\n    i0.ɵɵelement(48, \"p-sortIcon\", 33);\n    i0.ɵɵelementStart(49, \"p-columnFilter\", 34);\n    i0.ɵɵtemplate(50, DefineEmployeeComponent_ng_template_6_ng_template_50_Template, 1, 3, \"ng-template\", 35);\n    i0.ɵɵelementEnd()()()()();\n  }\n}\nfunction DefineEmployeeComponent_ng_template_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 37)(1, \"td\", 12)(2, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function DefineEmployeeComponent_ng_template_7_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const em_r12 = restoredCtx.$implicit;\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.openEditItem(em_r12.emId, true));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 39);\n    i0.ɵɵlistener(\"click\", function DefineEmployeeComponent_ng_template_7_Template_button_click_3_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r14);\n      const em_r12 = restoredCtx.$implicit;\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.openEditItem(em_r12.emId, false));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\");\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"td\")(15, \"level-status\", 40);\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const em_r12 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"pSelectableRow\", em_r12);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(em_r12.emCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(em_r12.firstName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(em_r12.lastName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(em_r12.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(em_r12.emStdEmStd);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"status\", ctx_r3.getNameById(em_r12.emStatus));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r3.getNameById(em_r12.emStatus), \" \");\n  }\n}\nfunction DefineEmployeeComponent_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2, \" No records found \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"colspan\", 7);\n  }\n}\nconst _c0 = function () {\n  return [25, 50, 100];\n};\nexport let DefineEmployeeComponent = /*#__PURE__*/(() => {\n  class DefineEmployeeComponent {\n    constructor(empServ, empProvider, enumsrv) {\n      this.empServ = empServ;\n      this.empProvider = empProvider;\n      this.enumsrv = enumsrv;\n      this.em_data = [];\n      this.subscriptions = [];\n      this.enumList = [];\n      this.enumClonedList = [];\n      this.enumEmStatus = [];\n      this.rowCount = UtilConstant.ROW_COUNT;\n      this.totalElements = 0;\n      this.paginationObj = {\n        pageNo: 0,\n        pageSize: this.rowCount,\n        sortBy: [\"emId\"],\n        sortOrder: \"ASC\"\n      };\n      this.filterCriteriaList = [];\n      this.isSorted = false;\n      this.isFiltered = false;\n    }\n    ngOnInit() {\n      this.loadEnums();\n      this.loadRecords();\n    }\n    loadEnums() {\n      this.enumList = [];\n      this.enumsrv.getEnums().subscribe(res => {\n        this.enumList = res;\n        this.enumClonedList = this.enumList.map(x => Object.assign({}, x));\n        this.enumEmStatus = this.enumClonedList.filter(t => t.tableName.toLocaleUpperCase() === 'em'.toLocaleUpperCase() && t.fieldName.toLocaleUpperCase() === 'em_status'.toLocaleUpperCase());\n        this.enumEmStatus.unshift(new EnumList(null, '', '', 'Make a selection', null));\n      }, error => {\n        // this.loginError = error.errorDesc;\n      });\n    }\n    getNameById(id) {\n      return id ? this.enumEmStatus.find(t => t.enumKey == id) != null ? this.enumEmStatus.find(t => t.enumKey == id)?.enumValue : '' : '';\n    }\n    loadRecords() {\n      let data = {\n        filterDto: {\n          paginationDTO: this.paginationObj,\n          filterCriteria: this.filterCriteriaList\n        }\n      };\n      this.isFiltered = false;\n      this.empServ.getAllEmployeeListPaginated(data).subscribe(res => {\n        if (res) {\n          this.isFiltered = false;\n          this.em_data = res.content ? res.content : [];\n          this.totalElements = res.totalElements ? res.totalElements : 0;\n        }\n      });\n    }\n    openEditItem(em_id, edtiMode) {\n      const dialogConfig = new MatDialogConfig();\n      dialogConfig.disableClose = true;\n      dialogConfig.autoFocus = true;\n      dialogConfig.width = '750px';\n      dialogConfig.data = {\n        em_id: em_id,\n        isEdit: edtiMode,\n        newRecord: !edtiMode\n      };\n      this.empProvider.openDialog(dialogConfig);\n      if (this.dialogClosedSubscription) {\n        this.dialogClosedSubscription.unsubscribe();\n      }\n      this.dialogClosedSubscription = this.empProvider.onDialogueClosed.subscribe(result => {\n        if (result == true) this.loadRecords();\n      });\n    }\n    onAddEmployee() {\n      const dialogConfig = new MatDialogConfig();\n      dialogConfig.disableClose = true;\n      dialogConfig.autoFocus = true;\n      dialogConfig.width = '750px';\n      dialogConfig.data = {\n        em_id: 0,\n        isEdit: true,\n        newRecord: true\n      };\n      this.empProvider.openDialog(dialogConfig);\n      this.empProvider.onDialogueClosed.subscribe(result => {\n        if (result == true) this.loadRecords();\n      });\n    }\n    onPageChange(event) {\n      const pageNo = event.first ? event.first / event.rows : 0;\n      const pageSize = event.rows;\n      this.paginationObj.pageNo = pageNo;\n      this.paginationObj.pageSize = pageSize;\n      this.loadRecords();\n    }\n    onSort(event) {\n      //this.isSorted = true;\n    }\n    onInnerFilter(event) {\n      this.isSorted = false;\n      setTimeout(() => {\n        if (this.isFiltered && !this.isSorted) {\n          this.isSorted = false;\n          Object.keys(event.filters).forEach(field => {\n            const filterValue = event.filters[field][0].value;\n            const matchMode = event.filters[field][0].matchMode;\n            if (filterValue !== undefined) {\n              let filterCriteria = {};\n              if (field == \"emStdEmStd\") {\n                filterCriteria = {\n                  fieldName: \"emStd.emStd\",\n                  value: filterValue,\n                  matchMode: matchMode\n                };\n              } else {\n                filterCriteria = {\n                  fieldName: field,\n                  value: filterValue,\n                  matchMode: matchMode\n                };\n              }\n              this.updateFilterCriteriaList(filterCriteria);\n            }\n          });\n          // if (this.filterCriteriaList.length!=0) {\n          //   this.paginationObj.pageNo = 0;\n          // }\n          this.paginationObj.pageNo = 0;\n          this.loadRecords();\n        }\n        this.isFiltered = true;\n      }, 0);\n    }\n    updateFilterCriteriaList(filterCriteria) {\n      let index = this.filterCriteriaList.findIndex(item => item.fieldName === filterCriteria['fieldName']);\n      if (filterCriteria['value'] == null) {\n        if (index !== -1) {\n          this.filterCriteriaList.splice(index, 1);\n        }\n      } else {\n        if (index !== -1) {\n          this.filterCriteriaList[index] = filterCriteria;\n        } else {\n          this.filterCriteriaList.push(filterCriteria);\n        }\n      }\n    }\n    static #_ = this.ɵfac = function DefineEmployeeComponent_Factory(t) {\n      return new (t || DefineEmployeeComponent)(i0.ɵɵdirectiveInject(i1.EmployeeService), i0.ɵɵdirectiveInject(i2.EmployeeModalDialogueProvider), i0.ɵɵdirectiveInject(i3.EnumService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DefineEmployeeComponent,\n      selectors: [[\"app-define-employee\"]],\n      viewQuery: function DefineEmployeeComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(MatSort, 5);\n          i0.ɵɵviewQuery(MatPaginator, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n        }\n      },\n      decls: 11,\n      vars: 11,\n      consts: [[1, \"card\", 2, \"height\", \"91vh\"], [\"header\", \" \"], [\"pTemplate\", \"icons\"], [1, \"card\"], [\"styleClass\", \"p-datatable-responsive-demo p-datatable-gridlines\", \"scrollDirection\", \"both\", \"scrollHeight\", \"540px\", 3, \"value\", \"paginator\", \"rows\", \"rowHover\", \"scrollable\", \"onFilter\", \"onSort\"], [\"dt1\", \"\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [1, \"paginator\"], [\"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", 3, \"rows\", \"totalRecords\", \"first\", \"showCurrentPageReport\", \"rowsPerPageOptions\", \"onPageChange\"], [\"pButton\", \"\", \"label\", \"Add\", \"icon\", \"pi pi-plus\", 3, \"click\"], [2, \"width\", \"8rem\"], [\"pSortableColumn\", \"emCode\"], [1, \"grid-header-column\"], [1, \"grid-header-label\"], [1, \"grid-label-paragraph\"], [1, \"grid-sort-icon\"], [\"field\", \"emCode\"], [\"type\", \"text\", \"field\", \"emCode\", \"display\", \"menu\"], [\"pSortableColumn\", \"firstName\"], [\"field\", \"firstName\"], [\"type\", \"text\", \"field\", \"firstName\", \"display\", \"menu\"], [\"pSortableColumn\", \"lastName\"], [\"field\", \"lastName\"], [\"type\", \"text\", \"field\", \"lastName\", \"display\", \"menu\"], [\"pSortableColumn\", \"email\"], [\"field\", \"email\"], [\"type\", \"text\", \"field\", \"email\", \"display\", \"menu\"], [\"pSortableColumn\", \"emStdEmStd\"], [\"field\", \"emStdEmStd\"], [\"type\", \"text\", \"field\", \"emStdEmStd\", \"display\", \"menu\"], [\"pSortableColumn\", \"emStatus\"], [\"field\", \"emStatus\"], [\"field\", \"emStatus\", \"matchMode\", \"equals\", \"display\", \"menu\"], [\"pTemplate\", \"filter\"], [\"optionLabel\", \"enumValue\", \"optionValue\", \"enumKey\", \"placeholder\", \"Select a Type\", 3, \"ngModel\", \"options\", \"showClear\", \"onChange\"], [3, \"pSelectableRow\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", \"icon\", \"pi pi-pencil\", 1, \"p-button-text\", \"p-button-rounded\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", \"icon\", \"pi pi-eye\", 1, \"p-button-text\", \"p-button-rounded\", \"pull-right\", 3, \"click\"], [3, \"status\"]],\n      template: function DefineEmployeeComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"p-panel\", 1);\n          i0.ɵɵtemplate(2, DefineEmployeeComponent_ng_template_2_Template, 1, 0, \"ng-template\", 2);\n          i0.ɵɵelementStart(3, \"div\", 3)(4, \"p-table\", 4, 5);\n          i0.ɵɵlistener(\"onFilter\", function DefineEmployeeComponent_Template_p_table_onFilter_4_listener($event) {\n            return ctx.onInnerFilter($event);\n          })(\"onSort\", function DefineEmployeeComponent_Template_p_table_onSort_4_listener($event) {\n            return ctx.onSort($event);\n          });\n          i0.ɵɵtemplate(6, DefineEmployeeComponent_ng_template_6_Template, 51, 0, \"ng-template\", 6);\n          i0.ɵɵtemplate(7, DefineEmployeeComponent_ng_template_7_Template, 17, 8, \"ng-template\", 7);\n          i0.ɵɵtemplate(8, DefineEmployeeComponent_ng_template_8_Template, 3, 1, \"ng-template\", 8);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(9, \"div\", 9)(10, \"p-paginator\", 10);\n          i0.ɵɵlistener(\"onPageChange\", function DefineEmployeeComponent_Template_p_paginator_onPageChange_10_listener($event) {\n            return ctx.onPageChange($event);\n          });\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"value\", ctx.em_data)(\"paginator\", false)(\"rows\", ctx.rowCount)(\"rowHover\", false)(\"scrollable\", true);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"rows\", ctx.rowCount)(\"totalRecords\", ctx.totalElements)(\"first\", ctx.paginationObj.pageNo * ctx.paginationObj.pageSize)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(10, _c0));\n        }\n      },\n      dependencies: [i4.NgControlStatus, i4.NgModel, i5.PrimeTemplate, i6.Table, i6.SortableColumn, i6.SelectableRow, i6.SortIcon, i6.ColumnFilter, i7.ButtonDirective, i8.Dropdown, i9.Panel, i10.LevelStatusComponent, i11.Paginator],\n      styles: [\".mat-dialog-title-ext[_ngcontent-%COMP%]{background-color:#879cc9;padding-left:10px;font-weight:400;margin-bottom:0}.mat-dialog-content-ext[_ngcontent-%COMP%]{margin:0;padding:10px}.mat-dialog-actions-ext[_ngcontent-%COMP%]{border-top:none;padding:3px;min-height:36px!important;margin-bottom:5px;background-color:#fff!important}.action-buttons[_ngcontent-%COMP%]{height:30px;width:70px}.margin-left-20[_ngcontent-%COMP%]{margin-left:20px}.margin-5[_ngcontent-%COMP%]{margin:5px!important}.mat-card[_ngcontent-%COMP%]{border-radius:0}.mat-expansion-panel-header-title[_ngcontent-%COMP%]{color:#fff;letter-spacing:1px}.mat-card-title[_ngcontent-%COMP%]{color:#fff;letter-spacing:1px;font-size:13px;margin:0!important}.mat-card-header-text[_ngcontent-%COMP%]{margin:0!important}.mat-card-header[_ngcontent-%COMP%]{padding:5px!important;margin-left:-15px}.mat-card-content[_ngcontent-%COMP%], .mat-expansion-panel-content[_ngcontent-%COMP%]{background-color:#fff!important}.mat-button[_ngcontent-%COMP%], .mat-flat-button[_ngcontent-%COMP%], .mat-icon-button[_ngcontent-%COMP%], .mat-stroked-button[_ngcontent-%COMP%]{line-height:inherit!important}.btn-filter[_ngcontent-%COMP%]{margin-left:4px;margin-right:5px;width:50px;margin-top:17px}.btn-ggb-orange[_ngcontent-%COMP%]{width:90px!important}.btn-ggb-default-custom[_ngcontent-%COMP%]{margin:16px!important}\"]\n    });\n  }\n  return DefineEmployeeComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}