{"ast":null,"code":"import { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"src/app/services/users.service\";\nimport * as i3 from \"src/app/services/auth.service\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"primeng/api\";\nimport * as i6 from \"primeng/button\";\nimport * as i7 from \"primeng/dialog\";\nimport * as i8 from \"ngx-image-cropper\";\nfunction AddUserPhotoComponent_p_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.errorMsg);\n  }\n}\nfunction AddUserPhotoComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 15)(2, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function AddUserPhotoComponent_div_11_Template_button_click_2_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.zoomOut());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function AddUserPhotoComponent_div_11_Template_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.zoomIn());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(4, \"div\", 15);\n    i0.ɵɵelementEnd();\n  }\n}\nconst _c0 = function () {\n  return {\n    \"margin-left\": \".5em\"\n  };\n};\nfunction AddUserPhotoComponent_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"p-button\", 18);\n    i0.ɵɵlistener(\"click\", function AddUserPhotoComponent_ng_template_16_Template_p_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r7.uploadImage());\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(1, \"p-button\", 19);\n    i0.ɵɵlistener(\"click\", function AddUserPhotoComponent_ng_template_16_Template_p_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.confirmDialog());\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"disabled\", ctx_r3.NotImage);\n    i0.ɵɵadvance(1);\n    i0.ɵɵstyleMap(i0.ɵɵpureFunction0(3, _c0));\n  }\n}\nconst _c1 = function () {\n  return {\n    width: \"50vw\"\n  };\n};\nconst _c2 = function () {\n  return {\n    \"960px\": \"75vw\",\n    \"640px\": \"100vw\"\n  };\n};\nexport let AddUserPhotoComponent = /*#__PURE__*/(() => {\n  class AddUserPhotoComponent {\n    constructor(data, dialogRef, userSrv, authSrv) {\n      this.data = data;\n      this.dialogRef = dialogRef;\n      this.userSrv = userSrv;\n      this.authSrv = authSrv;\n      this.display = false;\n      this.imageChangedEvent = '';\n      this.croppedImage = '';\n      this.rotation = 0;\n      this.scale = 1;\n      this.showCropper = false;\n      this.containWithinAspectRatio = false;\n      this.NotImage = true;\n      this.canvasRotation = 0;\n      this.transform = {};\n      this.fileName = \"No File Chooseen\";\n      this.errorMsg = '';\n    }\n    ngOnInit() {\n      this.display = this.data.display;\n    }\n    fileChangeEvent(event) {\n      this.NotImage = true;\n      this.imageChangedEvent = event;\n      this.selectedFile = event.target.files[0];\n      this.fileName = this.selectedFile.name;\n      var idxDot = this.fileName.lastIndexOf(\".\") + 1;\n      var extFile = this.fileName.substr(idxDot, this.fileName.length).toLowerCase();\n      if (extFile == \"jpg\" || extFile == \"jpeg\" || extFile == \"png\") {\n        var imgSize = event.target.files[0].size;\n        this.fileName = this.selectedFile.name;\n        if (imgSize > 1000000) {\n          this.NotImage = true;\n          this.errorMsg = 'Image Size should not be greater than 1 MB';\n        } else {\n          this.NotImage = false;\n          this.errorMsg = '';\n        }\n      } else {\n        this.NotImage = true;\n        //alert(\"Only jpg/jpeg and png files are allowed!\");\n        this.errorMsg = 'Only jpg/jpeg and png files are allowed!';\n      }\n    }\n    imageCropped(event) {\n      let file = new File([event.blob ?? \"\"], this.fileName);\n      this.selectedFile = file;\n    }\n    imageLoaded() {\n      this.showCropper = true;\n      //console.log('Image loaded');\n    }\n\n    cropperReady(sourceImageDimensions) {\n      //console.log('Cropper ready', sourceImageDimensions);\n    }\n    loadImageFailed() {\n      // show message\n    }\n    zoomOut() {\n      this.scale -= 0.1;\n      this.transform = {\n        ...this.transform,\n        scale: this.scale\n      };\n    }\n    zoomIn() {\n      this.scale += 0.1;\n      this.transform = {\n        ...this.transform,\n        scale: this.scale\n      };\n    }\n    confirmDialog() {\n      this.dialogRef.close(false);\n    }\n    uploadImage() {\n      if (this.errorMsg.length > 0 || this.NotImage) {\n        return;\n      }\n      const uploadData = new FormData();\n      uploadData.set('imageFile', this.selectedFile);\n      // uploadData.append(\"imageFile\", this.croppedImage);\n      uploadData.set(\"tableName\", 'em');\n      uploadData.set(\"fieldName\", 'em_photo');\n      uploadData.set(\"pkeyValue\", this.authSrv.getLoggedInUserEMId());\n      // uploadData.set(\"imageName\", this.fileName);\n      this.userSrv.uploadProfilePhto(uploadData).subscribe(res => {\n        console.log(res);\n        this.dialogRef.close(true);\n      });\n    }\n    dataURItoBlob(dataURI) {\n      const binary = atob(dataURI.split(',')[1]);\n      const array = [];\n      for (let i = 0; i < binary.length; i++) {\n        array.push(binary.charCodeAt(i));\n      }\n      return new Blob([new Uint8Array(array)], {\n        type: 'image/png'\n      });\n    }\n    static #_ = this.ɵfac = function AddUserPhotoComponent_Factory(t) {\n      return new (t || AddUserPhotoComponent)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.MatDialogRef), i0.ɵɵdirectiveInject(i2.UsersService), i0.ɵɵdirectiveInject(i3.AuthService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: AddUserPhotoComponent,\n      selectors: [[\"app-add-user-photo\"]],\n      decls: 17,\n      vars: 28,\n      consts: [[\"header\", \"Select Profile Photo\", 3, \"visible\", \"breakpoints\", \"closable\", \"modal\", \"closeOnEscape\", \"visibleChange\"], [1, \"container\"], [1, \"row\"], [1, \"col-sm-12\", \"col-md-12\"], [2, \"display\", \"flex\"], [\"pButton\", \"\", \"label\", \"Select File \", \"type\", \"button\", \"icon\", \"pi pi-image\", \"iconPos\", \"left\", 1, \"p-button\", 2, \"margin-right\", \"5px\", 3, \"click\"], [1, \"filename\"], [\"type\", \"file\", \"hidden\", \"\", \"accept\", \"image/png, image/jpg, image/jpeg\", 2, \"margin-bottom\", \"3px\", 3, \"change\"], [\"_fileInput\", \"\"], [\"class\", \"form-field-lable\", \"style\", \"color: red;\", 4, \"ngIf\"], [\"class\", \"row\", 4, \"ngIf\"], [1, \"col-sm-12\"], [\"format\", \"png\", 3, \"imageChangedEvent\", \"maintainAspectRatio\", \"containWithinAspectRatio\", \"aspectRatio\", \"cropperStaticHeight\", \"cropperStaticWidth\", \"hideResizeSquares\", \"resizeToWidth\", \"cropperMinWidth\", \"onlyScaleDown\", \"roundCropper\", \"canvasRotation\", \"transform\", \"alignImage\", \"imageCropped\", \"imageLoaded\", \"cropperReady\", \"loadImageFailed\"], [\"pTemplate\", \"footer\"], [1, \"form-field-lable\", 2, \"color\", \"red\"], [1, \"col-sm-6\", \"col-md-6\", \"col-xm-6\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", \"icon\", \"\", \"iconPos\", \"left\", \"icon\", \"pi pi-search-minus\", 1, \"p-button-rounded\", \"p-button-text\", 2, \"font-size\", \"1.5rem\", 3, \"click\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", \"icon\", \"pi pi-search-plus\", 1, \"p-button-rounded\", \"p-button-text\", \"ml10\", 3, \"click\"], [\"label\", \"Upload\", \"icon\", \"pi pi-upload\", \"styleClass\", \"p-button-primary\", 1, \"mr5\", 3, \"disabled\", \"click\"], [\"label\", \"Cancel\", \"icon\", \"pi pi-times\", \"styleClass\", \"p-button-secondary\", 3, \"click\"]],\n      template: function AddUserPhotoComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r10 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"p-dialog\", 0);\n          i0.ɵɵlistener(\"visibleChange\", function AddUserPhotoComponent_Template_p_dialog_visibleChange_0_listener($event) {\n            return ctx.display = $event;\n          });\n          i0.ɵɵelementStart(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"div\", 4)(5, \"button\", 5);\n          i0.ɵɵlistener(\"click\", function AddUserPhotoComponent_Template_button_click_5_listener() {\n            i0.ɵɵrestoreView(_r10);\n            const _r0 = i0.ɵɵreference(9);\n            return i0.ɵɵresetView(_r0.click());\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(6, \"p\", 6);\n          i0.ɵɵtext(7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"input\", 7, 8);\n          i0.ɵɵlistener(\"change\", function AddUserPhotoComponent_Template_input_change_8_listener($event) {\n            return ctx.fileChangeEvent($event);\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(10, AddUserPhotoComponent_p_10_Template, 2, 1, \"p\", 9);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(11, AddUserPhotoComponent_div_11_Template, 5, 0, \"div\", 10);\n          i0.ɵɵelementStart(12, \"div\", 1)(13, \"div\", 2)(14, \"div\", 11)(15, \"image-cropper\", 12);\n          i0.ɵɵlistener(\"imageCropped\", function AddUserPhotoComponent_Template_image_cropper_imageCropped_15_listener($event) {\n            return ctx.imageCropped($event);\n          })(\"imageLoaded\", function AddUserPhotoComponent_Template_image_cropper_imageLoaded_15_listener() {\n            return ctx.imageLoaded();\n          })(\"cropperReady\", function AddUserPhotoComponent_Template_image_cropper_cropperReady_15_listener($event) {\n            return ctx.cropperReady($event);\n          })(\"loadImageFailed\", function AddUserPhotoComponent_Template_image_cropper_loadImageFailed_15_listener() {\n            return ctx.loadImageFailed();\n          });\n          i0.ɵɵelementEnd()()()()();\n          i0.ɵɵtemplate(16, AddUserPhotoComponent_ng_template_16_Template, 2, 4, \"ng-template\", 13);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵstyleMap(i0.ɵɵpureFunction0(26, _c1));\n          i0.ɵɵproperty(\"visible\", ctx.display)(\"breakpoints\", i0.ɵɵpureFunction0(27, _c2))(\"closable\", false)(\"modal\", true)(\"closeOnEscape\", false);\n          i0.ɵɵadvance(7);\n          i0.ɵɵtextInterpolate(ctx.fileName);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.NotImage);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.showCropper);\n          i0.ɵɵadvance(4);\n          i0.ɵɵstyleProp(\"display\", ctx.showCropper ? null : \"none\");\n          i0.ɵɵproperty(\"imageChangedEvent\", ctx.imageChangedEvent)(\"maintainAspectRatio\", true)(\"containWithinAspectRatio\", ctx.containWithinAspectRatio)(\"aspectRatio\", 4 / 3)(\"cropperStaticHeight\", 100)(\"cropperStaticWidth\", 100)(\"hideResizeSquares\", true)(\"resizeToWidth\", 256)(\"cropperMinWidth\", 128)(\"onlyScaleDown\", true)(\"roundCropper\", true)(\"canvasRotation\", ctx.canvasRotation)(\"transform\", ctx.transform)(\"alignImage\", \"center\");\n        }\n      },\n      dependencies: [i4.NgIf, i5.PrimeTemplate, i6.ButtonDirective, i6.Button, i7.Dialog, i8.ImageCropperComponent],\n      styles: [\"image-cropper[_ngcontent-%COMP%]{height:30vh}.row[_ngcontent-%COMP%]{padding:10px}.filename[_ngcontent-%COMP%]{border:2px solid #2196F3;height:30px;padding:2px}\"]\n    });\n  }\n  return AddUserPhotoComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}