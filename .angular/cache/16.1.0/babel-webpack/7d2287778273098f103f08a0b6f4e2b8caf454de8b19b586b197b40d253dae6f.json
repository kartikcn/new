{"ast":null,"code":"import { MessageService } from 'primeng/api';\nimport { UtilConstant } from 'src/common/UtilConstant';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/enum.service\";\nimport * as i2 from \"src/app/ui/Helpdesk/work-request/service/add-work-request.services\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"primeng/api\";\nimport * as i5 from \"primeng/table\";\nimport * as i6 from \"primeng/dropdown\";\nimport * as i7 from \"primeng/toast\";\nimport * as i8 from \"primeng/panel\";\nimport * as i9 from \"primeng/confirmdialog\";\nimport * as i10 from \"@angular/forms\";\nimport * as i11 from \"@angular/material/tooltip\";\nfunction RequestLogComponent_ng_template_3_ng_template_41_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"p-dropdown\", 31);\n    i0.ɵɵlistener(\"onChange\", function RequestLogComponent_ng_template_3_ng_template_41_Template_p_dropdown_onChange_0_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const filter_r5 = restoredCtx.filterCallback;\n      return i0.ɵɵresetView(filter_r5($event.value));\n    });\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const value_r4 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"ngModel\", value_r4)(\"options\", ctx_r3.enumWrStatus)(\"showClear\", true);\n  }\n}\nfunction RequestLogComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"th\", 8)(2, \"div\", 9)(3, \"div\", 10)(4, \"p\", 11);\n    i0.ɵɵtext(5, \"Request Code\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 12);\n    i0.ɵɵelement(7, \"p-sortIcon\", 13)(8, \"p-columnFilter\", 14);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(9, \"th\", 15)(10, \"div\", 9)(11, \"div\", 10)(12, \"p\", 11);\n    i0.ɵɵtext(13, \"Changed By\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(14, \"div\", 12);\n    i0.ɵɵelement(15, \"p-sortIcon\", 16)(16, \"p-columnFilter\", 17);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(17, \"th\", 18)(18, \"div\", 9)(19, \"div\", 10)(20, \"p\", 11);\n    i0.ɵɵtext(21, \"Date Changed\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(22, \"div\", 12);\n    i0.ɵɵelement(23, \"p-sortIcon\", 19)(24, \"p-columnFilter\", 20);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(25, \"th\", 21)(26, \"div\", 9)(27, \"div\", 10)(28, \"p\", 11);\n    i0.ɵɵtext(29, \"Time Changed\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(30, \"div\", 12);\n    i0.ɵɵelement(31, \"p-sortIcon\", 22)(32, \"p-columnFilter\", 23);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(33, \"th\", 24)(34, \"div\", 9)(35, \"div\", 10)(36, \"p\", 11);\n    i0.ɵɵtext(37, \"Status\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(38, \"div\", 12);\n    i0.ɵɵelement(39, \"p-sortIcon\", 25);\n    i0.ɵɵelementStart(40, \"p-columnFilter\", 26);\n    i0.ɵɵtemplate(41, RequestLogComponent_ng_template_3_ng_template_41_Template, 1, 3, \"ng-template\", 27);\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(42, \"th\", 28)(43, \"div\", 9)(44, \"div\", 10)(45, \"p\", 11);\n    i0.ɵɵtext(46, \"Comments\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"div\", 12);\n    i0.ɵɵelement(48, \"p-sortIcon\", 29)(49, \"p-columnFilter\", 30);\n    i0.ɵɵelementEnd()()()();\n  }\n}\nfunction RequestLogComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 32)(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\", 33);\n    i0.ɵɵtext(13);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const requestLog_r8 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"pSelectableRow\", requestLog_r8);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(requestLog_r8.requestId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(requestLog_r8.userUserName);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 8, requestLog_r8.dateChanged, \"dd MMM yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(ctx_r1.convertToDisplayTime(requestLog_r8.timeChanged));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r1.getEnumById(requestLog_r8.status));\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"matTooltip\", requestLog_r8.comments);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", requestLog_r8.comments, \"\");\n  }\n}\nfunction RequestLogComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 34);\n    i0.ɵɵtext(2, \" No records found \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"colspan\", 6);\n  }\n}\nconst _c0 = function () {\n  return [5, 10, 25];\n};\nconst _c1 = function () {\n  return [\"\", \"partCode\", \"description\"];\n};\nexport let RequestLogComponent = /*#__PURE__*/(() => {\n  class RequestLogComponent {\n    constructor(enumsrv, wrSrv, datePipe) {\n      this.enumsrv = enumsrv;\n      this.wrSrv = wrSrv;\n      this.datePipe = datePipe;\n      this.requestLogData = [];\n      this.enumList = [];\n      this.enumClonedList = [];\n      this.enumWr = [];\n      this.enumWrStatus = [];\n      this.rowCount = UtilConstant.ROW_COUNT;\n    }\n    ngOnInit() {\n      this.loadEnums();\n    }\n    loadEnums() {\n      this.enumList = [];\n      this.enumsrv.getEnums().subscribe(res => {\n        this.enumList = res;\n        this.enumClonedList = this.enumList.map(x => Object.assign({}, x));\n        this.enumWr = this.enumClonedList.filter(t => t.tableName.toLocaleUpperCase() === 'wr'.toLocaleUpperCase());\n        this.enumWrStatus = this.enumWr.filter(t => t.fieldName.toLocaleUpperCase() === 'status'.toLocaleUpperCase());\n      }, error => {});\n    }\n    loadRequestLogData(requestId) {\n      this.wrSrv.getRequestLogByRequestId(requestId).subscribe(res => {\n        this.requestLogData = res;\n        this.requestLogData = this.requestLogData.sort((a, b) => a.requestLogId - b.requestLogId);\n        this.requestLogData = this.requestLogData.map(each => {\n          if (each.changedBy === null) {\n            return {\n              ...each,\n              userUserName: 'System',\n              formatedDateChanged: this.datePipe.transform(each.dateChanged, 'dd MMMM yyyy')\n            };\n          } else {\n            return {\n              ...each,\n              formatedDateChanged: this.datePipe.transform(each.dateChanged, 'dd MMMM yyyy')\n            };\n          }\n        });\n      });\n    }\n    getEnumById(enumKey) {\n      return this.enumWrStatus.find(t => t.enumKey === enumKey)?.enumValue;\n    }\n    convertToDisplayTime(value) {\n      if (value != null) {\n        var data = value.split(':');\n        var time = data[0] + ':' + data[1];\n        return time;\n      } else {\n        return '';\n      }\n    }\n    static #_ = this.ɵfac = function RequestLogComponent_Factory(t) {\n      return new (t || RequestLogComponent)(i0.ɵɵdirectiveInject(i1.EnumService), i0.ɵɵdirectiveInject(i2.AddWorkRequestService), i0.ɵɵdirectiveInject(i3.DatePipe));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: RequestLogComponent,\n      selectors: [[\"app-request-log\"]],\n      features: [i0.ɵɵProvidersFeature([MessageService])],\n      decls: 9,\n      vars: 10,\n      consts: [[1, \"card\"], [\"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", \"scrollDirection\", \"both\", \"scrollHeight\", \"500px\", \"styleClass\", \"p-datatable-responsive-demo p-datatable-gridlines\", 3, \"value\", \"paginator\", \"rows\", \"showCurrentPageReport\", \"scrollable\", \"rowsPerPageOptions\", \"globalFilterFields\", \"rowHover\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [\"key\", \"partSave\", \"position\", \"top-right\"], [\"key\", \"partwarning\", \"position\", \"top-center\"], [\"key\", \"partgrid\", \"header\", \"Confirmation\", \"icon\", \"pi pi-exclamation-triangle\"], [\"pSortableColumn\", \"requestId\"], [1, \"grid-header-column\"], [1, \"grid-header-label\"], [1, \"grid-label-paragraph\"], [1, \"grid-sort-icon\"], [\"field\", \"requestId\"], [\"type\", \"text\", \"field\", \"requestId\", \"display\", \"menu\"], [\"pSortableColumn\", \"userUserName\"], [\"field\", \"userUserName\"], [\"type\", \"text\", \"field\", \"userUserName\", \"display\", \"menu\"], [\"pSortableColumn\", \"formatedDateChanged\"], [\"field\", \"formatedDateChanged\"], [\"type\", \"text\", \"field\", \"formatedDateChanged\", \"display\", \"menu\"], [\"pSortableColumn\", \"timeChanged\"], [\"field\", \"timeChanged\"], [\"type\", \"text\", \"field\", \"timeChanged\", \"display\", \"menu\"], [\"pSortableColumn\", \"status\"], [\"field\", \"status\"], [\"field\", \"status\", \"matchMode\", \"equals\", \"display\", \"menu\"], [\"pTemplate\", \"filter\"], [\"pSortableColumn\", \"comments\"], [\"field\", \"comments\"], [\"type\", \"text\", \"field\", \"comments\", \"display\", \"menu\"], [\"optionLabel\", \"enumValue\", \"optionValue\", \"enumKey\", \"placeholder\", \"Select a Status\", 3, \"ngModel\", \"options\", \"showClear\", \"onChange\"], [3, \"pSelectableRow\"], [\"matTooltipPosition\", \"below\", 1, \"ellipsis\", 3, \"matTooltip\"], [2, \"text-align\", \"center\"]],\n      template: function RequestLogComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"p-panel\")(1, \"div\", 0)(2, \"p-table\", 1);\n          i0.ɵɵtemplate(3, RequestLogComponent_ng_template_3_Template, 50, 0, \"ng-template\", 2);\n          i0.ɵɵtemplate(4, RequestLogComponent_ng_template_4_Template, 14, 11, \"ng-template\", 3);\n          i0.ɵɵtemplate(5, RequestLogComponent_ng_template_5_Template, 3, 1, \"ng-template\", 4);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelement(6, \"p-toast\", 5)(7, \"p-toast\", 6)(8, \"p-confirmDialog\", 7);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"value\", ctx.requestLogData)(\"paginator\", true)(\"rows\", ctx.rowCount)(\"showCurrentPageReport\", true)(\"scrollable\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(8, _c0))(\"globalFilterFields\", i0.ɵɵpureFunction0(9, _c1))(\"rowHover\", false);\n        }\n      },\n      dependencies: [i4.PrimeTemplate, i5.Table, i5.SortableColumn, i5.SelectableRow, i5.SortIcon, i5.ColumnFilter, i6.Dropdown, i7.Toast, i8.Panel, i9.ConfirmDialog, i10.NgControlStatus, i10.NgModel, i11.MatTooltip, i3.DatePipe],\n      styles: [\".ellipsis[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}\"]\n    });\n  }\n  return RequestLogComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}