{"ast":null,"code":"import { MessageService } from 'primeng/api';\nimport { AddDivisionComponent } from './widgets/add-division/add-division.component';\nimport { AddDepartmentComponent } from './widgets/add-department/add-department.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./services/division.services\";\nimport * as i2 from \"primeng/api\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"primeng/button\";\nimport * as i5 from \"primeng/toast\";\nimport * as i6 from \"primeng/panel\";\nimport * as i7 from \"primeng/menu\";\nimport * as i8 from \"primeng/tree\";\nimport * as i9 from \"./widgets/add-division/add-division.component\";\nimport * as i10 from \"./widgets/add-department/add-department.component\";\nimport * as i11 from \"./widgets/add-sub-department/add-sub-department.component\";\nfunction DivisionDepartmentComponent_ng_template_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function DivisionDepartmentComponent_ng_template_3_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r8);\n      const _r6 = i0.ɵɵreference(2);\n      return i0.ɵɵresetView(_r6.toggle($event));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(1, \"p-menu\", 11, 12);\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"popup\", true)(\"model\", ctx_r0.reqitems);\n  }\n}\nfunction DivisionDepartmentComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"a\", 13);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const node_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"href\", node_r9.data, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(node_r9.label);\n  }\n}\nfunction DivisionDepartmentComponent_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"b\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const node_r10 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(node_r10.label);\n  }\n}\nfunction DivisionDepartmentComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-add-division\", 14);\n    i0.ɵɵlistener(\"parentFun\", function DivisionDepartmentComponent_div_8_Template_app_add_division_parentFun_1_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.refresh($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"isNew\", ctx_r3.isNew)(\"action\", ctx_r3.action)(\"formData\", ctx_r3.displayData);\n  }\n}\nfunction DivisionDepartmentComponent_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-add-department\", 14);\n    i0.ɵɵlistener(\"parentFun\", function DivisionDepartmentComponent_div_9_Template_app_add_department_parentFun_1_listener($event) {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.refresh($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"isNew\", ctx_r4.isNew)(\"action\", ctx_r4.action)(\"formData\", ctx_r4.displayData);\n  }\n}\nfunction DivisionDepartmentComponent_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"app-add-sub-department\", 14);\n    i0.ɵɵlistener(\"parentFun\", function DivisionDepartmentComponent_div_10_Template_app_add_sub_department_parentFun_1_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r15.refresh($event));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"isNew\", ctx_r5.isNew)(\"action\", ctx_r5.action)(\"formData\", ctx_r5.displayData);\n  }\n}\nexport let DivisionDepartmentComponent = /*#__PURE__*/(() => {\n  class DivisionDepartmentComponent {\n    constructor(divisionSrv, messageService) {\n      this.divisionSrv = divisionSrv;\n      this.messageService = messageService;\n      this.isNew = true;\n      this.action = '';\n      this.loading = false;\n      this.expandedNodes = [];\n      this.treeState = {};\n      this.isDivisionView = false;\n      this.isDepartmentView = false;\n      this.isSubDepartmentView = false;\n      this.reqitems = [];\n      this.reqitems = [{\n        'label': 'Division',\n        'icon': 'pi pi-plus',\n        command: event => {\n          this.addDivision();\n        }\n      }, {\n        'label': 'Department',\n        'icon': 'pi pi-plus',\n        command: event => {\n          this.addDepartment();\n        }\n      }, {\n        'label': 'Sub Department',\n        'icon': 'pi pi-plus',\n        command: event => {\n          this.addSubDepartment();\n        }\n      }];\n    }\n    ngOnInit() {\n      this.loadRecords();\n    }\n    loadRecords() {\n      const expandedNodes = this.getExpandedNodes();\n      this.loading = true;\n      this.nodes = [];\n      this.divisionSrv.getAllDivisionTreeList().subscribe(res => {\n        this.nodes = res;\n        this.loading = false;\n        expandedNodes.length > 0 ? this.restoreExpandedNodes(expandedNodes) : '';\n      });\n    }\n    getExpandedNodes() {\n      const expandedNodes = [];\n      if (this.nodes) {\n        this.nodes.forEach(node => {\n          if (node.expanded) {\n            expandedNodes.push(node);\n          }\n        });\n        return expandedNodes;\n      } else {\n        return expandedNodes;\n      }\n    }\n    restoreExpandedNodes(expandedNodes) {\n      const visitNode = node => {\n        if (node.expanded) {\n          node.expanded = false;\n          const foundNode = this.findNodeById(this.nodes, node.key);\n          if (foundNode) {\n            foundNode.expanded = true;\n            if (node.children) {\n              node.children.forEach(childNode => {\n                visitNode(childNode);\n              });\n            }\n          }\n        }\n      };\n      expandedNodes.forEach(node => {\n        visitNode(node);\n      });\n    }\n    findNodeById(nodes, id) {\n      let foundNode;\n      nodes.forEach(node => {\n        if (node.key === id) {\n          foundNode = node;\n        } else if (node.children) {\n          const childNode = this.findNodeById(node.children, id);\n          if (childNode) {\n            foundNode = childNode;\n          }\n        }\n      });\n      return foundNode;\n    }\n    nodeSelect(event) {\n      this.treeState.selectedNode = event.node;\n      if (event.node.parent === undefined) {\n        this.isNew = false;\n        this.isDivisionView = true;\n        this.isDepartmentView = false;\n        this.isSubDepartmentView = false;\n        this.action = \"Edit\";\n        this.displayData = event.node.data;\n      } else if (event.node.parent.parent == undefined) {\n        this.isNew = false;\n        this.isDivisionView = false;\n        this.isDepartmentView = true;\n        this.isSubDepartmentView = false;\n        this.action = \"Edit\";\n        this.displayData = event.node.data;\n      } else {\n        this.isNew = false;\n        this.isDivisionView = false;\n        this.isDepartmentView = false;\n        this.isSubDepartmentView = true;\n        this.action = \"Edit\";\n        this.displayData = event.node.data;\n      }\n      this.selectedRecord = event.node.data;\n      this.selectedNode = event.node;\n    }\n    onNodeExpand(event) {\n      if (!this.treeState.expandedNodes) {\n        this.treeState.expandedNodes = [];\n      }\n      this.treeState.expandedNodes.push(event.node);\n    }\n    addDivision() {\n      this.isNew = true;\n      this.isDivisionView = true;\n      this.isDepartmentView = false;\n      this.isSubDepartmentView = false;\n      this.action = \"Add\";\n      let data = {\n        divId: 0,\n        divCode: '',\n        description: '',\n        highlightColor: '#a6a6a6',\n        divHead: null\n      };\n      this.displayData = data;\n    }\n    addDepartment() {\n      this.isNew = true;\n      this.isDivisionView = false;\n      this.isDepartmentView = true;\n      this.isSubDepartmentView = false;\n      this.action = \"Add\";\n      let data = {\n        depId: 0,\n        depCode: '',\n        description: '',\n        highlightColor: '#a6a6a6',\n        depHead: null,\n        divId: null\n      };\n      this.displayData = data;\n    }\n    addSubDepartment() {\n      this.isNew = true;\n      this.isDivisionView = false;\n      this.isDepartmentView = false;\n      this.isSubDepartmentView = true;\n      this.action = \"Add\";\n      let data = {\n        subDepId: 0,\n        depId: null,\n        subDepCode: '',\n        description: '',\n        highlightColor: '#a6a6a6',\n        subDepHead: null,\n        divId: null\n      };\n      this.displayData = data;\n    }\n    refresh(action) {\n      this.selectedFiles = [];\n      this.selectedRecord = null;\n      this.isDivisionView = false;\n      this.isDepartmentView = false;\n      this.isSubDepartmentView = false;\n      this.displayData = null;\n      if (action) {\n        this.messageService.clear();\n        this.messageService.add({\n          key: 'save',\n          severity: 'success',\n          summary: 'Record saved successfully',\n          detail: 'Record saved successfully'\n        });\n        this.loadRecords();\n      }\n    }\n    static #_ = this.ɵfac = function DivisionDepartmentComponent_Factory(t) {\n      return new (t || DivisionDepartmentComponent)(i0.ɵɵdirectiveInject(i1.DivisionService), i0.ɵɵdirectiveInject(i2.MessageService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: DivisionDepartmentComponent,\n      selectors: [[\"app-division-department\"]],\n      viewQuery: function DivisionDepartmentComponent_Query(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵviewQuery(AddDivisionComponent, 5);\n          i0.ɵɵviewQuery(AddDepartmentComponent, 5);\n        }\n        if (rf & 2) {\n          let _t;\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.adddivisionPanel = _t.first);\n          i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.adddepartmentPanel = _t.first);\n        }\n      },\n      features: [i0.ɵɵProvidersFeature([MessageService])],\n      decls: 12,\n      vars: 7,\n      consts: [[1, \"row\"], [1, \"col-sm-6\", \"col-md-6\", \"col-xm-4\", \"col-lg-6\", 2, \"height\", \"90vh\"], [\"header\", \"Division and Department List\"], [\"pTemplate\", \"icons\"], [\"selectionMode\", \"single\", \"scrollHeight\", \"72vh\", 3, \"loading\", \"value\", \"selection\", \"filter\", \"selectionChange\", \"onNodeSelect\", \"onNodeExpand\"], [\"pTemplate\", \"url\"], [\"pTemplate\", \"default\"], [1, \"col-sm-6\", \"col-md-6\", \"col-xm-4\", \"col-lg-6\"], [4, \"ngIf\"], [\"key\", \"save\", \"position\", \"top-right\"], [\"pButton\", \"\", \"label\", \"Add\", \"icon\", \"pi pi-plus\", 3, \"click\"], [3, \"popup\", \"model\"], [\"showMenu\", \"\"], [3, \"href\"], [3, \"isNew\", \"action\", \"formData\", \"parentFun\"]],\n      template: function DivisionDepartmentComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"p-panel\", 2);\n          i0.ɵɵtemplate(3, DivisionDepartmentComponent_ng_template_3_Template, 3, 2, \"ng-template\", 3);\n          i0.ɵɵelementStart(4, \"p-tree\", 4);\n          i0.ɵɵlistener(\"selectionChange\", function DivisionDepartmentComponent_Template_p_tree_selectionChange_4_listener($event) {\n            return ctx.selectedFiles = $event;\n          })(\"onNodeSelect\", function DivisionDepartmentComponent_Template_p_tree_onNodeSelect_4_listener($event) {\n            return ctx.nodeSelect($event);\n          })(\"onNodeExpand\", function DivisionDepartmentComponent_Template_p_tree_onNodeExpand_4_listener($event) {\n            return ctx.onNodeExpand($event);\n          });\n          i0.ɵɵtemplate(5, DivisionDepartmentComponent_ng_template_5_Template, 2, 2, \"ng-template\", 5);\n          i0.ɵɵtemplate(6, DivisionDepartmentComponent_ng_template_6_Template, 2, 1, \"ng-template\", 6);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(7, \"div\", 7);\n          i0.ɵɵtemplate(8, DivisionDepartmentComponent_div_8_Template, 2, 3, \"div\", 8);\n          i0.ɵɵtemplate(9, DivisionDepartmentComponent_div_9_Template, 2, 3, \"div\", 8);\n          i0.ɵɵtemplate(10, DivisionDepartmentComponent_div_10_Template, 2, 3, \"div\", 8);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(11, \"p-toast\", 9);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"loading\", ctx.loading)(\"value\", ctx.nodes)(\"selection\", ctx.selectedFiles)(\"filter\", true);\n          i0.ɵɵadvance(4);\n          i0.ɵɵproperty(\"ngIf\", ctx.isDivisionView);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.isDepartmentView);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.isSubDepartmentView);\n        }\n      },\n      dependencies: [i3.NgIf, i2.PrimeTemplate, i4.ButtonDirective, i5.Toast, i6.Panel, i7.Menu, i8.Tree, i9.AddDivisionComponent, i10.AddDepartmentComponent, i11.AddSubDepartmentComponent],\n      styles: [\"[_nghost-%COMP%]     b, strong[_ngcontent-%COMP%]{font-weight:400}[_nghost-%COMP%]     chevrondownicon{font-size:1.5rem;font-weight:700;color:#0d89ec}[_nghost-%COMP%]     chevronrighticon{font-size:1.5rem;font-weight:700;color:#0d89ec}[_nghost-%COMP%]     chevronrighticon svg{width:16px;height:16px}[_nghost-%COMP%]     chevrondownicon svg{width:16px;height:16px}[_nghost-%COMP%]     chevronrighticon svg path{d:path(\\\"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z\\\")}[_nghost-%COMP%]     chevrondownicon svg path{d:path(\\\"M4 8a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7A.5.5 0 0 1 4 8z\\\")}[_nghost-%COMP%]     ::-webkit-scrollbar{width:6px!important}\"]\n    });\n  }\n  return DivisionDepartmentComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}