{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { MessageService } from 'primeng/api';\nimport { UtilConstant } from 'src/common/UtilConstant';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"primeng/api\";\nimport * as i4 from \"../../service/rm-resources.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"../../../../directive/numbers-only.directive\";\nimport * as i7 from \"primeng/button\";\nimport * as i8 from \"primeng/toast\";\nimport * as i9 from \"primeng/confirmdialog\";\nfunction RmResourcesFormComponent_tr_27_label_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 20);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.errorMsg);\n  }\n}\nfunction RmResourcesFormComponent_tr_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 18);\n    i0.ɵɵtemplate(2, RmResourcesFormComponent_tr_27_label_2_Template, 2, 1, \"label\", 19);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !(ctx_r0.rmResourcesFormPanel.controls[\"quanity\"] == null ? null : ctx_r0.rmResourcesFormPanel.controls[\"quanity\"].errors.required));\n  }\n}\nconst _c0 = function () {\n  return {\n    \"margin-left\": \".5em\"\n  };\n};\nexport let RmResourcesFormComponent = /*#__PURE__*/(() => {\n  class RmResourcesFormComponent {\n    constructor(data, formBuilder, dialog, dialogRef, confirmationService, rmResourceSrv, currencyPipe, messageService) {\n      this.data = data;\n      this.formBuilder = formBuilder;\n      this.dialog = dialog;\n      this.dialogRef = dialogRef;\n      this.confirmationService = confirmationService;\n      this.rmResourceSrv = rmResourceSrv;\n      this.currencyPipe = currencyPipe;\n      this.messageService = messageService;\n      this.errorMsg = '';\n      this.rmResourcesFormPanel = this.formBuilder.group({\n        title: [null, [Validators.required]],\n        quanity: [null, [Validators.required, this.checkGreaterThanZero()]],\n        costPerUnit: [null, [Validators.required]],\n        comments: ['']\n      });\n    }\n    ngOnInit() {\n      setTimeout(() => {\n        this.rmResourcesFormPanel.patchValue({\n          title: this.data.title,\n          costPerUnit: this.formatValue(this.data.costPerUnit, 'GBP', 2),\n          quanity: null,\n          comments: null\n        });\n      }, 0);\n    }\n    checkGreaterThanZero() {\n      return control => {\n        if (control.value !== undefined && control.value != null) {\n          this.rmResourcesFormPanel.controls['quanity'].setErrors(null);\n          this.rmResourcesFormPanel.clearAsyncValidators();\n          this.rmResourcesFormPanel.updateValueAndValidity();\n          if (control.value <= 0) {\n            this.rmResourcesFormPanel.controls['quanity'].setErrors({\n              'incorrect': true\n            });\n            this.rmResourcesFormPanel.updateValueAndValidity();\n            this.errorMsg = \"Quantity can not be less than one\";\n            return {\n              'incorrect': true\n            };\n          } else if (control.value > this.data.quantity) {\n            this.rmResourcesFormPanel.controls['quanity'].setErrors({\n              'incorrect': true\n            });\n            this.rmResourcesFormPanel.updateValueAndValidity();\n            this.errorMsg = \"Quantity can not be greater than the resource quantity \" + this.data.quantity;\n            return {\n              'incorrect': true\n            };\n          } else {\n            return null;\n          }\n        }\n        return null;\n      };\n    }\n    saveRecords() {\n      this.messageService.clear();\n      var RmResourceData = {\n        blId: this.data.blId,\n        flId: this.data.flId,\n        rmId: this.data.rmId,\n        quanity: this.rmResourcesFormPanel.controls.quanity.value,\n        costPerUnit: this.data.costPerUnit,\n        resourcesId: this.data.resourcesId,\n        comments: this.rmResourcesFormPanel.controls.comments.value,\n        rmResourcesId: this.data.rmResourcesId\n      };\n      console.log(RmResourceData);\n      this.rmResourceSrv.saveRmResource(RmResourceData).subscribe(res => {\n        if (res.rmResourcesId != null) {\n          this.dialogRef.close(res.rmResourcesId);\n        } else if (res.code != 200) {\n          this.messageService.add({\n            key: 'rmResource',\n            severity: 'error',\n            summary: 'error',\n            detail: res.text\n          });\n        }\n      });\n    }\n    confirmDialog() {\n      this.confirmationService.confirm({\n        message: UtilConstant.CANCEL_Msg,\n        header: 'Confirmation',\n        icon: 'pi pi-exclamation-triangle',\n        accept: () => {\n          this.dialogRef.close(null);\n        }\n      });\n    }\n    formatValue(value, symbol, decimal_pt) {\n      if (value !== 'undefined' && value != null) {\n        const temp = `${value}`.replace(/\\,/g, \"\");\n        var digit_format = \"1.\" + decimal_pt + \"-\" + decimal_pt;\n        return this.currencyPipe.transform(temp, symbol, 'symbol-narrow', digit_format);\n      } else {\n        return '';\n      }\n    }\n    deformatValue(value) {\n      return value.replace(/[\\n\\£\\,]+/g, '');\n    }\n    setCostPerUnitCurrenyFormat() {\n      var costPerReq = this.deformatValue(this.rmResourcesFormPanel.controls.costPerUnit.value);\n      setTimeout(() => {\n        this.rmResourcesFormPanel.patchValue({\n          costPerUnit: this.formatValue(costPerReq, 'GBP', 2)\n        });\n      }, 10);\n    }\n    static #_ = this.ɵfac = function RmResourcesFormComponent_Factory(t) {\n      return new (t || RmResourcesFormComponent)(i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i1.UntypedFormBuilder), i0.ɵɵdirectiveInject(i2.MatDialog), i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(i3.ConfirmationService), i0.ɵɵdirectiveInject(i4.RmResourcesService), i0.ɵɵdirectiveInject(i5.CurrencyPipe), i0.ɵɵdirectiveInject(i3.MessageService));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: RmResourcesFormComponent,\n      selectors: [[\"app-rm-resources-form\"]],\n      features: [i0.ɵɵProvidersFeature([MessageService])],\n      decls: 34,\n      vars: 8,\n      consts: [[\"mat-dialog-title\", \"\", 1, \"mat-dialog-title-ext\"], [1, \"mat-typography\", \"mat-dialog-content-ext\"], [\"autocomplete\", \"off\", 3, \"formGroup\"], [\"width\", \"100%\"], [2, \"width\", \"50%\"], [1, \"input-label-custom\"], [1, \"form-field-lable\", \"control-label\"], [\"type\", \"text\", \"name\", \"title\", \"formControlName\", \"title\", \"maxlength\", \"64\", 1, \"form-control\", 3, \"readOnly\"], [\"type\", \"text\", \"NumbersOnly\", \"\", \"name\", \"costPerUnit\", \"formControlName\", \"costPerUnit\", 1, \"form-control\", 3, \"readOnly\", \"change\"], [\"type\", \"text\", \"NumbersOnly\", \"\", \"name\", \"quanity\", \"formControlName\", \"quanity\", \"maxlength\", \"9\", 1, \"form-control\"], [1, \"form-field-lable\"], [\"type\", \"text\", \"name\", \"comments\", \"formControlName\", \"comments\", \"maxlength\", \"256\", 1, \"form-control\"], [4, \"ngIf\"], [\"align\", \"end\", 1, \"mat-dialog-actions-ext\"], [\"label\", \"Save\", \"icon\", \"pi pi-check\", 3, \"disabled\", \"click\"], [\"label\", \"Cancel\", \"icon\", \"pi pi-times\", \"styleClass\", \"p-button-secondary\", 3, \"click\"], [\"key\", \"rmResource\", \"position\", \"top-right\"], [\"header\", \"Confirmation\", \"icon\", \"pi pi-exclamation-triangle\"], [2, \"width\", \"25%\"], [\"class\", \"form-field-lable\", \"style\", \"color:red;\", 4, \"ngIf\"], [1, \"form-field-lable\", 2, \"color\", \"red\"]],\n      template: function RmResourcesFormComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"h2\", 0);\n          i0.ɵɵtext(1, \"Add Resources Details\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(2, \"mat-dialog-content\", 1)(3, \"form\", 2)(4, \"table\", 3)(5, \"tr\")(6, \"td\", 4)(7, \"div\", 5)(8, \"label\", 6);\n          i0.ɵɵtext(9, \"Resource Title\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(10, \"input\", 7);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(11, \"td\", 4)(12, \"div\", 5)(13, \"label\", 6);\n          i0.ɵɵtext(14, \" Cost Per unit\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"input\", 8);\n          i0.ɵɵlistener(\"change\", function RmResourcesFormComponent_Template_input_change_15_listener() {\n            return ctx.setCostPerUnitCurrenyFormat();\n          });\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(16, \"tr\")(17, \"td\", 4)(18, \"div\", 5)(19, \"label\", 6);\n          i0.ɵɵtext(20, \" Quanity\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(21, \"input\", 9);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(22, \"td\", 4)(23, \"div\", 5)(24, \"label\", 10);\n          i0.ɵɵtext(25, \"Comments\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(26, \"input\", 11);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵtemplate(27, RmResourcesFormComponent_tr_27_Template, 3, 1, \"tr\", 12);\n          i0.ɵɵelement(28, \"tr\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(29, \"mat-dialog-actions\", 13)(30, \"p-button\", 14);\n          i0.ɵɵlistener(\"click\", function RmResourcesFormComponent_Template_p_button_click_30_listener() {\n            return ctx.saveRecords();\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(31, \"p-button\", 15);\n          i0.ɵɵlistener(\"click\", function RmResourcesFormComponent_Template_p_button_click_31_listener() {\n            return ctx.confirmDialog();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(32, \"p-toast\", 16)(33, \"p-confirmDialog\", 17);\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"formGroup\", ctx.rmResourcesFormPanel);\n          i0.ɵɵadvance(7);\n          i0.ɵɵproperty(\"readOnly\", true);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"readOnly\", true);\n          i0.ɵɵadvance(12);\n          i0.ɵɵproperty(\"ngIf\", (ctx.rmResourcesFormPanel.controls[\"quanity\"] == null ? null : ctx.rmResourcesFormPanel.controls[\"quanity\"].errors) && ctx.rmResourcesFormPanel.controls[\"quanity\"].dirty);\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"disabled\", !ctx.rmResourcesFormPanel.valid);\n          i0.ɵɵadvance(1);\n          i0.ɵɵstyleMap(i0.ɵɵpureFunction0(7, _c0));\n        }\n      },\n      dependencies: [i5.NgIf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.MaxLengthValidator, i1.FormGroupDirective, i1.FormControlName, i2.MatDialogTitle, i2.MatDialogContent, i2.MatDialogActions, i6.NumbersOnlyDirective, i7.Button, i8.Toast, i9.ConfirmDialog],\n      styles: [\".mat-dialog-title-ext[_ngcontent-%COMP%]{background-color:#879cc9;padding-left:10px;font-weight:400;margin-bottom:0}.mat-dialog-content-ext[_ngcontent-%COMP%]{margin:0;padding:10px;background-color:#fff!important}.mat-dialog-actions-ext[_ngcontent-%COMP%]{border-top:none;padding:3px;min-height:36px!important;margin-bottom:5px;background-color:#fff!important}.margin-left-20[_ngcontent-%COMP%]{margin-left:20px}.margin-5[_ngcontent-%COMP%]{margin:5px!important}.mat-card[_ngcontent-%COMP%]{border-radius:0}.mat-expansion-panel[_ngcontent-%COMP%]{background-color:#879cc9}.mat-card-content[_ngcontent-%COMP%], .mat-expansion-panel-content[_ngcontent-%COMP%]{background-color:#fff!important}.mat-button[_ngcontent-%COMP%], .mat-flat-button[_ngcontent-%COMP%], .mat-icon-button[_ngcontent-%COMP%], .mat-stroked-button[_ngcontent-%COMP%]{line-height:inherit!important}.btn-filter[_ngcontent-%COMP%]{margin-left:4px;margin-right:5px;width:50px;margin-top:17px}.btn-ggb-orange[_ngcontent-%COMP%]{width:90px!important}.btn-ggb-default-custom[_ngcontent-%COMP%]{margin:16px!important}.form-field-lable[_ngcontent-%COMP%]{font-size:11px;margin-bottom:0;font-weight:500}.form-control[_ngcontent-%COMP%]{margin-top:-3px;padding-left:5px}[_ngcontent-%COMP%]::placeholder{color:#555;opacity:1}[_ngcontent-%COMP%]:-ms-input-placeholder{color:#555}[_ngcontent-%COMP%]::-ms-input-placeholder{color:#555}.ng-select.ng-select-single[_ngcontent-%COMP%]   .ng-select-container[_ngcontent-%COMP%]{border-radius:0!important}.mat-expansion-panel-header-title[_ngcontent-%COMP%]{color:#fff;letter-spacing:1px}.mat-card[_ngcontent-%COMP%]{padding:0;border:thin double rgb(181,155,90)}.mat-card-title[_ngcontent-%COMP%]{color:#fff;letter-spacing:1px;font-size:13px;margin:0!important}.mat-card-header-text[_ngcontent-%COMP%]{margin:0!important}.mat-card-header[_ngcontent-%COMP%]{padding:5px!important;margin-left:-15px}.action-buttons[_ngcontent-%COMP%]{height:30px;width:70px}\"]\n    });\n  }\n  return RmResourcesFormComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}