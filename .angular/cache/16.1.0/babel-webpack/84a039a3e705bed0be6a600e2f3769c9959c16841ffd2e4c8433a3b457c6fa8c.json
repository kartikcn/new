{"ast":null,"code":"import { MatDialogConfig } from '@angular/material/dialog';\nimport * as FileSaver from 'file-saver';\nimport { UtilConstant } from 'src/common/UtilConstant';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/ui/background-loc/provider/rm.provider\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"primeng/api\";\nimport * as i4 from \"primeng/table\";\nimport * as i5 from \"primeng/button\";\nfunction SpaceAllocationRoomListComponent_ng_template_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\");\n    i0.ɵɵelement(1, \"th\", 7);\n    i0.ɵɵelementStart(2, \"th\", 8)(3, \"div\", 9)(4, \"div\", 10)(5, \"p\", 11);\n    i0.ɵɵtext(6, \"Building Code\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 12);\n    i0.ɵɵelement(8, \"p-sortIcon\", 13)(9, \"p-columnFilter\", 14);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"th\", 15)(11, \"div\", 9)(12, \"div\", 10)(13, \"p\", 11);\n    i0.ɵɵtext(14, \" Floor Code\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 12);\n    i0.ɵɵelement(16, \"p-sortIcon\", 16)(17, \"p-columnFilter\", 17);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"th\", 18)(19, \"div\", 9)(20, \"div\", 10)(21, \"p\", 11);\n    i0.ɵɵtext(22, \" Room Code\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(23, \"div\", 12);\n    i0.ɵɵelement(24, \"p-sortIcon\", 19)(25, \"p-columnFilter\", 20);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(26, \"th\");\n    i0.ɵɵtext(27, \"Employee Code\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"th\");\n    i0.ɵɵtext(29, \"Division Code\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"th\");\n    i0.ɵɵtext(31, \"Department Code\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"th\");\n    i0.ɵɵtext(33, \"Sub Department Code\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(34, \"th\", 21)(35, \"div\", 9)(36, \"div\", 10)(37, \"p\", 11);\n    i0.ɵɵtext(38, \"Date From\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(39, \"div\", 12);\n    i0.ɵɵelement(40, \"p-sortIcon\", 22)(41, \"p-columnFilter\", 23);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(42, \"th\", 24)(43, \"div\", 9)(44, \"div\", 10)(45, \"p\", 11);\n    i0.ɵɵtext(46, \"Date To\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(47, \"div\", 12);\n    i0.ɵɵelement(48, \"p-sortIcon\", 25)(49, \"p-columnFilter\", 26);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(50, \"th\", 27)(51, \"div\", 9)(52, \"div\", 10)(53, \"p\", 11);\n    i0.ɵɵtext(54, \"Area (sq.ft)\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(55, \"div\", 12);\n    i0.ɵɵelement(56, \"p-sortIcon\", 28);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(57, \"th\");\n    i0.ɵɵtext(58, \"Allocation (%)\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction SpaceAllocationRoomListComponent_ng_template_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\", 29)(1, \"td\", 7)(2, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function SpaceAllocationRoomListComponent_ng_template_5_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const rm_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.viewItem(rm_r3));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"td\");\n    i0.ɵɵtext(16);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(17, \"td\");\n    i0.ɵɵtext(18);\n    i0.ɵɵpipe(19, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"td\");\n    i0.ɵɵtext(21);\n    i0.ɵɵpipe(22, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"td\", 31);\n    i0.ɵɵtext(24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(25, \"td\", 31);\n    i0.ɵɵtext(26);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const rm_r3 = ctx.$implicit;\n    i0.ɵɵproperty(\"pSelectableRow\", rm_r3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(rm_r3.blCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.flCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.rmCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.emCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.divCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.depCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.subDepCode);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(19, 12, rm_r3.dateFrom, \"dd MMM yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(22, 15, rm_r3.dateTo, \"dd MMM yyyy\"));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(rm_r3.area.toFixed(2));\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(rm_r3.allocatedPercentage.toFixed(2));\n  }\n}\nfunction SpaceAllocationRoomListComponent_ng_template_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2, \" No records found \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵattribute(\"colspan\", 7);\n  }\n}\nconst _c0 = function () {\n  return [5, 10, 25];\n};\nexport let SpaceAllocationRoomListComponent = /*#__PURE__*/(() => {\n  class SpaceAllocationRoomListComponent {\n    constructor(rmProvider, cdr, datePipe) {\n      this.rmProvider = rmProvider;\n      this.cdr = cdr;\n      this.datePipe = datePipe;\n      this.rm_data = [];\n      this.rm_array = [];\n      this.rowCount = UtilConstant.ROW_COUNT;\n    }\n    ngOnInit() {\n      this.rm_data = this.data;\n      this.cdr.detectChanges();\n    }\n    viewItem(rm) {\n      const dialogConfig = new MatDialogConfig();\n      dialogConfig.disableClose = true;\n      dialogConfig.autoFocus = true;\n      dialogConfig.width = '750px';\n      dialogConfig.data = {\n        isView: true,\n        bl_id: rm.blId,\n        fl_id: rm.flId,\n        rm_id: rm.rmId,\n        isEdit: true,\n        newRecord: false\n      };\n      this.rmProvider.openDialog(dialogConfig);\n      this.rmProvider.onDialogueClosed.subscribe(result => {});\n    }\n    exportExcel() {\n      this.getDestructuredData(this.rm_data);\n      var excelHeaders = [];\n      import(\"xlsx\").then(xlsx => {\n        const worksheet = xlsx.utils.json_to_sheet(this.rm_array);\n        worksheet['!cols'] = [{\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }, {\n          wch: 20\n        }];\n        excelHeaders = [\"Building Code\", \"Floor Code\", \"Room Code\", \"Employee Code\", \"Division Code\", \"Department Code\", \"Sub Department Code\", \"Date From\", \"Date To\", \"Area (sq.ft)\", \"Allocation (%)\"];\n        const headers = excelHeaders.map((header, index) => ({\n          v: header,\n          position: String.fromCharCode(65 + index) + 1\n        }));\n        headers.forEach(header => {\n          worksheet[header.position] = {\n            v: header.v\n          };\n        });\n        const workbook = {\n          Sheets: {\n            'data': worksheet\n          },\n          SheetNames: ['data']\n        };\n        const excelBuffer = xlsx.write(workbook, {\n          bookType: 'xlsx',\n          type: 'array'\n        });\n        this.saveAsExcelFile(excelBuffer, \"room\");\n      });\n    }\n    getDestructuredData(data) {\n      this.rm_array = data.map(item => {\n        return {\n          \"Building Code\": item['blCode'],\n          \"Floor Code\": item['flCode'],\n          \"Room Code\": item['rmCode'],\n          \"Employee Code\": item['emCode'],\n          \"Division Code\": item['divCode'],\n          \"Department Code\": item['depCode'],\n          \"Sub Department Code\": item['subDepCode'],\n          \"Date From\": this.datePipe.transform(item['dateFrom'], \"dd MMM yyyy\"),\n          \"Date To\": this.datePipe.transform(item['dateTo'], \"dd MMM yyyy\"),\n          \"Area (sq.ft)\": item['area'],\n          \"Allocation (%)\": item['allocatedPercentage']\n        };\n      });\n    }\n    saveAsExcelFile(buffer, fileName) {\n      let EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8';\n      let EXCEL_EXTENSION = '.xlsx';\n      const data = new Blob([buffer], {\n        type: EXCEL_TYPE\n      });\n      FileSaver.saveAs(data, fileName + '_export_' + new Date().getTime() + EXCEL_EXTENSION);\n    }\n    static #_ = this.ɵfac = function SpaceAllocationRoomListComponent_Factory(t) {\n      return new (t || SpaceAllocationRoomListComponent)(i0.ɵɵdirectiveInject(i1.RMModalDialogueProvider), i0.ɵɵdirectiveInject(i0.ChangeDetectorRef), i0.ɵɵdirectiveInject(i2.DatePipe));\n    };\n    static #_2 = this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: SpaceAllocationRoomListComponent,\n      selectors: [[\"app-space-allocation-room-list\"]],\n      inputs: {\n        data: \"data\"\n      },\n      decls: 7,\n      vars: 10,\n      consts: [[1, \"card\"], [2, \"margin\", \"10px\"], [\"type\", \"button\", \"pButton\", \"\", \"pRipple\", \"\", \"icon\", \"pi pi-file-excel\", \"matTooltip\", \"XLS\", \"matTooltipPosition\", \"below\", 1, \"p-button-success\", \"p-mr-2\", \"pull-right\", 3, \"disabled\", \"click\"], [\"currentPageReportTemplate\", \"Showing {first} to {last} of {totalRecords} entries\", \"styleClass\", \"p-datatable-responsive-demo p-datatable-gridlines\", \"scrollDirection\", \"both\", \"scrollHeight\", \"350px\", 3, \"value\", \"paginator\", \"rows\", \"showCurrentPageReport\", \"rowsPerPageOptions\", \"rowHover\", \"scrollable\", \"totalRecords\"], [\"pTemplate\", \"header\"], [\"pTemplate\", \"body\"], [\"pTemplate\", \"emptymessage\"], [2, \"width\", \"4rem\"], [\"pSortableColumn\", \"blCode\"], [1, \"grid-header-column\"], [1, \"grid-header-label\"], [1, \"grid-label-paragraph\"], [1, \"grid-sort-icon\"], [\"field\", \"blCode\"], [\"type\", \"text\", \"field\", \"blCode\", \"display\", \"menu\"], [\"pSortableColumn\", \"flCode\"], [\"field\", \"flCode\"], [\"type\", \"text\", \"field\", \"flCode\", \"display\", \"menu\"], [\"pSortableColumn\", \"rmCode\"], [\"field\", \"rmCode\"], [\"type\", \"text\", \"field\", \"rmCode\", \"display\", \"menu\"], [\"pSortableColumn\", \"dateFrom\"], [\"field\", \"dateFrom\"], [\"type\", \"text\", \"field\", \"dateFrom\", \"display\", \"menu\"], [\"pSortableColumn\", \"dateTo\"], [\"field\", \"dateTo\"], [\"type\", \"text\", \"field\", \"dateTo\", \"display\", \"menu\"], [\"pSortableColumn\", \"area\"], [\"field\", \"area\"], [3, \"pSelectableRow\"], [\"pButton\", \"\", \"pRipple\", \"\", \"type\", \"button\", \"icon\", \"pi pi-eye\", 1, \"p-button-text\", \"p-button-rounded\", \"pull-right\", 3, \"click\"], [2, \"text-align\", \"right\"]],\n      template: function SpaceAllocationRoomListComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"button\", 2);\n          i0.ɵɵlistener(\"click\", function SpaceAllocationRoomListComponent_Template_button_click_2_listener() {\n            return ctx.exportExcel();\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(3, \"p-table\", 3);\n          i0.ɵɵtemplate(4, SpaceAllocationRoomListComponent_ng_template_4_Template, 59, 0, \"ng-template\", 4);\n          i0.ɵɵtemplate(5, SpaceAllocationRoomListComponent_ng_template_5_Template, 27, 18, \"ng-template\", 5);\n          i0.ɵɵtemplate(6, SpaceAllocationRoomListComponent_ng_template_6_Template, 3, 1, \"ng-template\", 6);\n          i0.ɵɵelementEnd()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"disabled\", ctx.rm_data.length == 0);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"value\", ctx.rm_data)(\"paginator\", true)(\"rows\", ctx.rowCount)(\"showCurrentPageReport\", true)(\"rowsPerPageOptions\", i0.ɵɵpureFunction0(9, _c0))(\"rowHover\", false)(\"scrollable\", true)(\"totalRecords\", ctx.rm_data.length);\n        }\n      },\n      dependencies: [i3.PrimeTemplate, i4.Table, i4.SortableColumn, i4.SelectableRow, i4.SortIcon, i4.ColumnFilter, i5.ButtonDirective, i2.DatePipe]\n    });\n  }\n  return SpaceAllocationRoomListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}